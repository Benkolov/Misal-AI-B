{% load static %}
<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" type="text/css" href="{% static 'css/styles.css' %}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>

    <title>MisalAI</title>
</head>
<body>

<header class="header">
    <div class="header-container">
        <h1 class="logo"><a href="{% url 'post list' %}">MisalAI</a></h1>
        <div class="user-controls">
            {% if user.is_authenticated %}
                <a href="{% url 'profile' pk=user.pk %}" class="btn">{{ user.username }}</a>
                <form method="post" action="{% url 'logout' %}" class="logout-form" id="logoutForm">
                    {% csrf_token %}
                    <button type="submit" class="btn logout">–ò–∑—Ö–æ–¥</button>
                </form>
                {% if user.is_staff %}
                    <a href="{% url 'post create' %}" class="btn">+ –ù–æ–≤–∞ –ø—É–±–ª–∏–∫–∞—Ü–∏—è</a>
                    <a href="{% url 'admin:index' %}" class="btn">–ê–¥–º–∏–Ω</a>
                {% endif %}
            {% else %}
                <a href="{% url 'login' %}" class="btn">–í—Ö–æ–¥</a>
                <a href="{% url 'register' %}" class="btn">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</a>
            {% endif %}
        </div>
    </div>
</header>

<nav class="navbar">
    <div class="nav-container">
        <ul class="nav-links">
            <li><a href="{% url 'post list' %}">Home</a></li>
            {% for category in categories %}
                <li><a href="{% url 'category detail' category.slug %}">{{ category.name }}</a></li>
            {% endfor %}
{#            <li><a href="{% url 'category list' %}">–í—Å–∏—á–∫–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</a></li>#}
            <li><a href="#">Contact</a></li>
        </ul>


        <div class="search-box">
            <form action="{% url 'search posts' %}" method="GET" class="search-form">
                <input type="text"
                       name="q"
                       placeholder="Search posts..."
                       class="search-input"
                       value="{{ request.GET.q|default:'' }}">
                <button type="submit" class="search-button">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="11" cy="11" r="8"></circle>
                        <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
                    </svg>
                </button>
            </form>
        </div>
    </div>
</nav>

<div class="container">
    {% block content %}
    {% endblock %}
</div>

<!-- –ü–æ–¥–æ–±—Ä–µ–Ω —Ñ—É—Ç—ä—Ä -->
<footer class="footer">
  <div class="footer-container">
    <div class="footer-section">
      <h3>–ù–∞–≤–∏–≥–∞—Ü–∏—è</h3>
      <ul>
        <li><a href="/">–ù–∞—á–∞–ª–æ</a></li>

        {% for category in categories %}
                <li><a href="{% url 'category detail' category.slug %}">{{ category.name }}</a></li>
            {% endfor %}
        <li><a href="/contact">–ö–æ–Ω—Ç–∞–∫—Ç–∏</a></li>
      </ul>
    </div>
    <div class="footer-section">
      <h3>–ö–æ–Ω—Ç–∞–∫—Ç–∏</h3>
      <p>Email: info@yourblog.com</p>
      <p>–¢–µ–ª–µ—Ñ–æ–Ω: +359 888 123 456</p>
    </div>
    <div class="footer-section">
      <h3>–ü–æ—Å–ª–µ–¥–≤–∞–π—Ç–µ –Ω–∏</h3>
      <div class="social-icons">
        <a href="#"><i class="fab fa-facebook"></i></a>
        <a href="#"><i class="fab fa-twitter"></i></a>
        <a href="#"><i class="fab fa-linkedin"></i></a>
      </div>
    </div>
  </div>
</footer>


<script>
document.addEventListener("DOMContentLoaded", function () {
    document.querySelectorAll("pre").forEach((preBlock) => {
        let button = document.createElement("button");
        button.innerText = "üìã –ö–æ–ø–∏—Ä–∞–π";
        button.classList.add("copy-button");

        preBlock.style.position = "relative";
        preBlock.appendChild(button);

        button.addEventListener("click", async () => {
            let code = preBlock.querySelector("code").innerText;
            try {
                await navigator.clipboard.writeText(code);
                button.innerText = "‚úÖ –ö–æ–ø–∏—Ä–∞–Ω–æ!";
                setTimeout(() => (button.innerText = "üìã –ö–æ–ø–∏—Ä–∞–π"), 2000);
            } catch (err) {
                console.error("–ì—Ä–µ—à–∫–∞ –ø—Ä–∏ –∫–æ–ø–∏—Ä–∞–Ω–µ", err);
            }
        });
    });
});

async function handleLogout() {
    try {
        const response = await fetch('/api/auth/logout/', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'X-CSRFToken': document.querySelector('[name=csrfmiddlewaretoken]').value
            },
        });

        if (response.ok) {
            window.location.href = '{% url "post list" %}';
        } else {
            console.error('Logout failed');
        }
    } catch (error) {
        console.error('Error:', error);
    }
}
</script>


</body>
</html>
